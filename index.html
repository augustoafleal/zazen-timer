<!DOCTYPE html>
<html>

<head>
  <title>Zazen</title>
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("/zazen-timer/sw.js");
    }

    let wakeLock = null;

    async function requestWakeLock() {
      try {
        wakeLock = await navigator.wakeLock.request('screen');

        wakeLock.addEventListener('release', () => {
          wakeLock = null;
        });
      } catch (err) {
        console.error('Error activating Wake Lock:', err);
      }
    }

    document.addEventListener('click', async () => {
      if (!wakeLock) {
        await requestWakeLock();
      }
    }, { once: true });

    document.addEventListener('visibilitychange', async () => {
      if (document.visibilityState === 'visible' && !wakeLock) {
        await requestWakeLock();
      }
    });
  </script>
  <link rel="manifest" href="/zazen-timer/manifest.json" />
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta charset="UTF-8" />
  <link rel="preload" as="script" href="/zazen-timer/assets/zazen_timer-ed7cd2f393e276e6.js" crossorigin>
  <link rel="preload" as="fetch" type="application/wasm" href="/zazen-timer/assets/zazen_timer_bg-d6b8f6f8f8f3da96.wasm"
    crossorigin>
</head>

<body>
  <div id="main"></div>
  <script>
    // We can't use a module script here because we need to start the script immediately when streaming
    import("/zazen-timer/assets/zazen_timer-ed7cd2f393e276e6.js").then(
      ({ default: init }) => {
        init("/zazen-timer/assets/zazen_timer_bg-d6b8f6f8f8f3da96.wasm").then((wasm) => {
          if (wasm.__wbindgen_start == undefined) {
            wasm.main();
          }
        });
      }
    );
  </script>

</body>

</html>